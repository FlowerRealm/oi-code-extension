name: è°ƒè¯• - PRè¯„è®ºè§¦å‘

on:
  issue_comment:
    types: [created]

jobs:
  debug-comment:
    if: ${{ github.event_name == 'issue_comment' && github.event.issue.pull_request }}
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“ è°ƒè¯•PRè¯„è®ºä¿¡æ¯
        run: |
          echo "ğŸ” PR è¯„è®ºè°ƒè¯•ä¿¡æ¯"
          echo "===================="
          echo "è¯„è®ºå†…å®¹: ${{ github.event.comment.body }}"
          echo "è¯„è®ºID: ${{ github.event.comment.id }}"
          echo "è¯„è®ºç”¨æˆ·: ${{ github.event.comment.user.login }}"
          echo "Issue/PR å·ç : ${{ github.event.issue.number }}"
          echo "æ˜¯å¦ä¸ºPR: ${{ github.event.issue.pull_request != null }}"
          echo "äº‹ä»¶åç§°: ${{ github.event_name }}"
          echo "äº‹ä»¶æ“ä½œ: ${{ github.event.comment.action || 'N/A' }}"

          COMMENT="${{ github.event.comment.body }}"
          echo ""
          echo "ğŸ“‹ åˆ†æè¯„è®ºå†…å®¹..."
          echo "åŸå§‹è¯„è®º: '$COMMENT'"

          if echo "$COMMENT" | grep -q '\bdocker-push\b'; then
            echo "âœ… æ£€æµ‹åˆ° 'docker-push' å…³é”®è¯"
            echo "ğŸš€ è¯„è®ºåŒ¹é…æˆåŠŸï¼Œä¼šè§¦å‘Dockeræ„å»º"
          else
            echo "âŒ æœªæ£€æµ‹åˆ° 'docker-push' å…³é”®è¯"
            echo "â„¹ï¸  è¯·åœ¨è¯„è®ºä¸­ä½¿ç”¨ 'docker-push' æ¥è§¦å‘Dockeræ„å»º"
          fi

          # æ˜¾ç¤ºæ‰€æœ‰å…³é”®è¯åŒ¹é…
          echo ""
          echo "ğŸ” æ£€æŸ¥æ‰€æœ‰å…³é”®è¯:"
          if echo "$COMMENT" | grep -q 'docker-push'; then echo "âœ… docker-push found"; else echo "âŒ docker-push not found"; fi
          if echo "$COMMENT" | grep -q '\blinux\b'; then echo "âœ… linux found - é»˜è®¤å¹³å°"; else echo "â„¹ï¸ linux not found - ä½¿ç”¨é»˜è®¤Linux"; fi
          if echo "$COMMENT" | grep -q '\bwindows\b'; then echo "âœ… windows found - Windowså¹³å°"; fi
          if echo "$COMMENT" | grep -q '\ball\b'; then echo "âœ… all found - å…¨å¹³å°"; fi

          echo ""
          echo "ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹:"
          echo "  - docker-push              (Linuxå¹³å°)"
          echo "  - docker-push linux        (Linuxå¹³å°)"
          echo "  - docker-push windows      (Windowså¹³å°)"
          echo "  - docker-push all          (å…¨å¹³å°)"

      - name: ğŸ¯ æ¨¡æ‹Ÿè§¦å‘Dockeræ„å»º
        if: ${{ contains(github.event.comment.body, 'docker-push') }}
        run: |
          echo "ğŸ¯ Dockeræ„å»ºæ¨¡æ‹Ÿè§¦å‘æˆåŠŸ!"
          echo "ğŸ“ è¿™æ˜¯è°ƒè¯•æ¨¡å¼ï¼Œå®é™…Dockeræ„å»ºå·¥ä½œæµåº”è¯¥ä¼šè¢«è§¦å‘"
          echo ""
          echo "ğŸ” å¦‚æœå®é™…å·¥ä½œæµæ²¡æœ‰è§¦å‘ï¼Œè¯·æ£€æŸ¥:"
          echo "1. å·¥ä½œæµæ–‡ä»¶æ˜¯å¦å­˜åœ¨: .github/workflows/docker-build.yml"
          echo "2. Docker Hub Token æ˜¯å¦æ­£ç¡®é…ç½®: secrets.DOCKER_HUB_TOKEN"
          echo "3. åˆ†æ”¯æ˜¯å¦æœ‰æƒé™æ‰§è¡Œç”Ÿäº§ç¯å¢ƒjob"
          echo ""
          echo "ğŸ“‹ å½“å‰ç¯å¢ƒä¿¡æ¯:"
          echo "- Repository: ${{ github.repository }}"
          echo "- Branch: ${{ github.ref }}"
          echo "- SHA: ${{ github.sha }}"
